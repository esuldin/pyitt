name: Run Bandit Scan
description: Analyzes the Python code with Bandit.

author: Egor Suldin
branding:
  icon: check
  color: yellow

runs:
  using: composite
  steps:
    - name: Scan with Bandit (POSIX)
      if: runner.os != 'Windows'
      run: |
        bandit --ini .bandit -f sarif -o results.sarif -r || true
      shell: sh
    - name: Scan with Bandit (Windows)
      if: runner.os == 'Windows'
      run: |
        bandit --ini .bandit -f sarif -o results.sarif -r & ver>nul
      shell: cmd
    - name: Upload SARIF file
      uses: github/codeql-action/upload-sarif@45cbd0c69e560cd9e7cd7f8c32362050c9b7ded2 #  v4.32.2
      with:
        sarif_file: results.sarif
